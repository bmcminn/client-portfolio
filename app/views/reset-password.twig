<?php require('_head.twig'); ?>


    <div class="user-form l-center content card grid">
        <h1>Reset Password</h1>

        <?php
            $disabled = '';

            if (!$req['hash_exists']):
                $disabled = 'disabled';
        ?>
        <div class="alert alert-danger">
            This password reset link has expired. Please request a new one on the <a href="<?php echo ROUTE_GET_RESET_PASSWORD; ?>">password reset</a> request page.
        </div>
        <?php endif; ?>


        <form id="password-reset-form" user-form class="grid"
            action="<?php echo ROUTE_POST_RESET_PASSWORD; ?>" method="post"
            successHandler="resetPasswordSuccessHandler"
            errorHandler="formErrorHandler">

            <div class="form-group">
                <label for="userpassword">New Password</label>
                <input type="password" id="userpassword" autocomplete="new-password" minlength="6" placeholder="Enter password" required <?php echo $disabled; ?>>
            </div>

            <div class="form-group">
                <label for="userpasswordconfirm">New Password Confirm</label>
                <input type="password" id="userpasswordconfirm" autocomplete="new-password" minlength="6" placeholder="Enter password" matches="userpassword" required <?php echo $disabled; ?>>
            </div>

            <?php if ($req['hash_exists']): ?>
                <input id="hash" type="hidden" value="<?php echo $hash; ?>">
            <?php endif; ?>

            <div class="form-group">
                <button user-form-submit class="btn-primary btn-block" type="submit" <?php echo $disabled; ?>>Submit</button>
            </div>
        </form>

        <div>
            <a href="<?php echo ROUTE_GET_LOGIN; ?>">Login</a>
        </div>
    </div>

<?php
    $footerClass = 'login-footer';
    require('_footer.twig');
?>

<?php require('_login-scripts.twig'); ?>

<?php require('_foot.twig'); ?>
